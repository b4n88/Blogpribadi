<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Albani">
<meta name="dcterms.date" content="2025-01-11">

<title>STATISTICIAN &amp; MARKET RESEARCH - Lanjutan dari analisis office ATK</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../ratakanan.css">
<link rel="stylesheet" href="../Bloog/blogstyle.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STATISTICIAN &amp; MARKET RESEARCH</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/al-bani-532b06294/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/b4n_88"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cleaning-data" id="toc-cleaning-data" class="nav-link active" data-scroll-target="#cleaning-data">Cleaning data</a></li>
  <li><a href="#memilih-variable" id="toc-memilih-variable" class="nav-link" data-scroll-target="#memilih-variable">Memilih Variable</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul class="collapse">
  <li><a href="#analisis-deskripsi" id="toc-analisis-deskripsi" class="nav-link" data-scroll-target="#analisis-deskripsi">1. Analisis Deskripsi</a></li>
  <li><a href="#cluster-analysis" id="toc-cluster-analysis" class="nav-link" data-scroll-target="#cluster-analysis">2. Cluster Analysis</a></li>
  </ul></li>
  <li><a href="#strategi" id="toc-strategi" class="nav-link" data-scroll-target="#strategi">Strategi</a>
  <ul class="collapse">
  <li><a href="#strategi-kuadran-i" id="toc-strategi-kuadran-i" class="nav-link" data-scroll-target="#strategi-kuadran-i">Strategi Kuadran I</a></li>
  <li><a href="#strategi-kuadran-ii" id="toc-strategi-kuadran-ii" class="nav-link" data-scroll-target="#strategi-kuadran-ii">Strategi Kuadran II</a></li>
  <li><a href="#strategi-kuadran-iii" id="toc-strategi-kuadran-iii" class="nav-link" data-scroll-target="#strategi-kuadran-iii">Strategi Kuadran III</a></li>
  <li><a href="#strategi-kuadran-iv" id="toc-strategi-kuadran-iv" class="nav-link" data-scroll-target="#strategi-kuadran-iv">Strategi Kuadran IV</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lanjutan dari analisis office ATK</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Data Analyst</div>
    <div class="quarto-category">Market Research</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Albani </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p><em>Jawaban adalah masukan dari Pak ikang, saya comot dan coba jelaskan dengan bahasa saya.. Terima kasih Pak insigtnya</em></p>
</blockquote>
<hr>
<p>Tulisan ini adalah tulisan dari soal pada <a href="https://b4n88.github.io/Blogpribadi/Bloog/12%20Clustering%20dengan%20Excel.html">tulisan saya sebelumnya</a>, Karena kemarin saya tidak menuliskan jawabannya. Seperti yang sudah saya tuliskan cara yang bisa kita lakukan untuk analisa ini adalah :</p>
<ol type="1">
<li>Pareto Analysis</li>
<li>Cluster Analysis</li>
<li>Trend &amp; Time Series Anlysis</li>
<li>Safety Stock &amp; Reorder Point Analysis</li>
<li>Analisis ABC XYZ</li>
</ol>
<p>Data setnya sudah saya upload di github saya klik <a href="https://github.com/b4n88/Market-Research/tree/main/Office%20study%20case">di sini</a>.</p>
<p>Sesuai petunjuk dari Pak Ikang, maka saya akan coba menuliskan jawaban dengan metode :</p>
<p><strong>Cluster Analysis</strong></p>
<p>Menurut saya langkah yang harus dilakukan adalah :</p>
<section id="cleaning-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-data">Cleaning data</h2>
<p>awal yang harus dilakukan adalah cleaning data. Apa itu cleaning data? yaitu tahap pembersihan dan pengecekan data pengecekan ini apakah datanya sudah konsisten atau tidak dan lain-lain. Kenapa harus melakukan cleaning data meskipun sudah ada validasi dari pengirim bahwa data sudah bersih. Ini mengingatkan saya pada saat ikut <a href="https://digitalent.komdigi.go.id/">TSA by Cominfo</a>, Pak Rangga yang merupakan tim penguji kami mengatakan “Sebagai praktisi kita harus melakukan pengecekan data terlebih dahulu”. Ini berkorelasi dengan <a href="https://b4n88.github.io/Blogpribadi/Bloog/07%20Mindset.html">tulisan pak Aep</a> sebelumnya yang saya copas dalam Blog saya ini. Analisa itu tergantung data, sekecil apapun ketidak konsistenan data akan berpengaruh pada keputusan. Jangan anggap remeh hal yang 1 ini.</p>
<p>Clening data bagaimana? saya hanya mau memastikan apakah nama item dan kodenya sudah sesuai? karena bisa jadi ada kesalahan typo yang bisa membahayakan. Sejauh ini datanya sudah lumayan bersih type datanya sudah aman juga. Sehingga hanya melakukan validasi saja apakah jumalh kode barang dan nama barang berjumlah sama?</p>
<p>Benar sekali ternyata data antara <code>Nama Iten</code> &amp; <code>Kode item</code> itu tidak sesuai, sehingga dalam analisa hanya butuh menggunakan Colom <code>Nama item</code> saja. Karena kita mengasumsikan ada 1 <code>Kode item</code> yang menggunakan <code>nama item</code> yang sama. Karena dari study case hanya membahas inbound dan outbound maka hanya perlu menganalisa data <code>pengeluaran product</code>.</p>
</section>
<section id="memilih-variable" class="level2">
<h2 class="anchored" data-anchor-id="memilih-variable">Memilih Variable</h2>
<p>Setelah data sudah bersih, Variable yang saya butuhkan adalah hanya mengambil beberapa varible penting yaitu ; Tanggal dan di bagi menjadi 3 bagian (DD, MM &amp; YYYY), Nama Item, Jumlah QTY dan Harga.</p>
<p>Harga diambil dari data Inbound sisanya dari outbound. Data bersihnya sudah saya simpan dalam <a href="https://github.com/b4n88/Market-Research/tree/main/Office%20study%20case">github saya</a>.</p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>Dalam eksekusi ini ada 2 hal yang harus kita analisa :</p>
<ul>
<li>Analisa dekriptif</li>
<li>Analisa klaster (Clastering)</li>
</ul>
<section id="analisis-deskripsi" class="level3">
<h3 class="anchored" data-anchor-id="analisis-deskripsi">1. Analisis Deskripsi</h3>
<p>Membuat analisa deskriptif untuk membaca data lebih jelas. Dengan menggunakan fitur <code>pivot table</code> pada excel. Saya mendapatkan beberapa analisa penting dalam analisa saya yaitu :</p>
<ul>
<li>Ada item yang digunakan pada tahun 2023 namun <strong>tidak ada</strong> pada tahun sebelumnya</li>
<li>Ada item yang digunakan pada tahun sebelumnya namun <strong>tidak ada</strong> pada tahun 2023.</li>
</ul>
<p>Asumsi saya adalah karena alat yang ada pada tahun sebelumnya sudah tidak berlaku lagi atau diganti dengan item baru sebagai contoh adalah Materai <code>3000</code> dan <code>6000</code>.</p>
<p>Hasil analisa deskriptifnya bisa di lihat pada excelan saya.</p>
</section>
<section id="cluster-analysis" class="level3">
<h3 class="anchored" data-anchor-id="cluster-analysis">2. Cluster Analysis</h3>
<p>Cluster ini saya akan klasifikasikan pada data QTY dan harga, sehingga akan menjadi klaster klaster yang saya bagi menjadi 4 :</p>
<ol type="1">
<li>Kuadran 1, memiliki high price dan high demand.</li>
<li>Kuadran 2, memiliki high price dan low demand.</li>
<li>Kuadran 3, memiliki low price dan low demand.</li>
<li>Kuadran 4, memiliki low price dan high demand.</li>
</ol>
<p>Cara melakukan clastering dengan Excel :</p>
<ol type="1">
<li>Siapkan data yang sudah diolah dan bersih sebersih bersihnya.</li>
<li>Buat Median masing masing variable (<code>=MEDIAN(B2)</code>) Ini berlaku untuk ke-2 variable.</li>
<li>Buat tanda variable high atau low (<code>=IF(C2&gt;=[Median_Harga],"High","Low")</code>)</li>
<li>Buat claster berdasarkan kategori kuadran (<code>=IF(AND(D2="HIGH",E2="HIGH"),"KUADRAN  1",IF(AND(D2="HIGH",E2="LOW"),"KUADRAN 2",IF(AND(D2="LOW",E2="LOW"),"KUADRAN  3","KUADRAN 4")))</code>)</li>
</ol>
<p>Jika sudah maka hasilnya akan seperti berikut.</p>
<ol type="1">
<li>Kuadran 1, memiliki high price dan high demand = <code>17</code></li>
<li>Kuadran 2, memiliki high price dan low demand = <code>22</code></li>
<li>Kuadran 3, memiliki low price dan low demand = <code>16</code></li>
<li>Kuadran 4, memiliki low price dan high demand = <code>21</code>.</li>
</ol>
<hr>
</section>
</section>
<section id="strategi" class="level2">
<h2 class="anchored" data-anchor-id="strategi">Strategi</h2>
<section id="strategi-kuadran-i" class="level3">
<h3 class="anchored" data-anchor-id="strategi-kuadran-i">Strategi Kuadran I</h3>
<section id="high-price---high-demand" class="level4">
<h4 class="anchored" data-anchor-id="high-price---high-demand"><em>High Price - High Demand</em></h4>
<ul>
<li>Melakukan pembelian ATK secara berkala (pada waktu tertentu - tidak di setiap bulan) tergantung dari siklus permintaan ATK dari <em>user</em>.
<ul>
<li>Perhitungan stok bisa dihitung dari total permintaan ATK untuk beberapa bulan sebelum pembelian.</li>
<li>Overstok masih diperbolehkan.</li>
</ul></li>
<li>Oleh karena harga ATK mahal dan diperlukan banyak, kita bisa meminta diskon khusus kepada <em>supplier</em>.</li>
</ul>
<hr>
</section>
</section>
<section id="strategi-kuadran-ii" class="level3">
<h3 class="anchored" data-anchor-id="strategi-kuadran-ii">Strategi Kuadran II</h3>
<section id="high-price---low-demand" class="level4">
<h4 class="anchored" data-anchor-id="high-price---low-demand"><em>High Price - Low Demand</em></h4>
<ul>
<li>Melakukan pembelian ATK secara hati-hati agar tidak overstok.
<ul>
<li>Kuantitas pembelian bisa dihitung dari total permintaan historikal pada tahun lalu dan pembelian dilakukan cukup sekali saja per tahun, <strong>ATAU</strong></li>
<li>Pembelian dilakukan ketika ada permintaan namun <em>user</em> bisa diinformasikan mengenai <em>leadtime</em> pengadaan ATK.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="strategi-kuadran-iii" class="level3">
<h3 class="anchored" data-anchor-id="strategi-kuadran-iii">Strategi Kuadran III</h3>
<section id="low-price---low-demand" class="level4">
<h4 class="anchored" data-anchor-id="low-price---low-demand"><em>Low Price - Low Demand</em></h4>
<ul>
<li>Melakukan pembelian ATK secara hati-hati agar tidak overstok.
<ul>
<li>Kuantitas pembelian bisa dihitung dari total permintaan historikal pada tahun lalu dan pembelian dilakukan cukup sekali saja per tahun, <strong>ATAU</strong></li>
<li>Oleh karena ATK ini termasuk ke dalam kategori <em>low price</em>, bisa diasumsikan bahwa produk ATK ini memiliki <em>leadtime</em> yang juga cepat. Maka kita bisa lakukan pembelian secara mendadak saat ada permintaan. Tidak perlu ada stok yang disimpan.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="strategi-kuadran-iv" class="level3">
<h3 class="anchored" data-anchor-id="strategi-kuadran-iv">Strategi Kuadran IV</h3>
<section id="low-price---high-demand" class="level4">
<h4 class="anchored" data-anchor-id="low-price---high-demand"><em>Low Price - High Demand</em></h4>
<ul>
<li>Melakukan pembelian ATK dengan mempertimbangkan stok aman masing-masing ATK pada waktu yang dibutuhkan.
<ul>
<li>Perhitungan <em>safety stok</em> bisa memanfaatkan prinsip perhitungan DOI ATK agar tidak terjadi overstok.</li>
</ul></li>
<li>Oleh karena ATK ini termasuk ke dalam kategori <em>low price</em>, bisa diasumsikan bahwa produk ATK ini memiliki <em>leadtime</em> yang juga cepat.</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<footer style="text-align: center; margin-top: 20px; font-size: 14px; color: #777;">

  <p>albani.idm88@gmail.com</p>

  <p>Copyright © 2024 Albani :v</p>

</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>